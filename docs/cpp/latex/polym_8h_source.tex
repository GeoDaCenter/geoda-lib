\doxysection{polym.\+h}
\hypertarget{polym_8h_source}{}\label{polym_8h_source}\index{/Users/xun/github/geoda-\/lib/src/cpp/regression/polym.h@{/Users/xun/github/geoda-\/lib/src/cpp/regression/polym.h}}
\mbox{\hyperlink{polym_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{\ Characteristic\ polynomial\ problem\ solving.}}
\DoxyCodeLine{00003\ \textcolor{comment}{*/}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ \_\_GEODA\_CENTER\_POLYM\_H\_\_}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ \_\_GEODA\_CENTER\_POLYM\_H\_\_}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ SL\_SMALL\_MATRIX\ 5}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ SL\_SMALL\ 1e-\/14}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_power_sym_lag_8h}{regression/PowerSymLag.h}}"{}}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ geoda\_sqr(x)\ ((x)\ *\ (x))}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{comment}{//***\ here\ go\ global\ variables\ for\ the\ characteristic\ polynomial\ algorithm}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \mbox{\hyperlink{polym_8h_a5b5a395141319c5c13666a272aa1f645}{SL\_Max\_Precision}};\ \ \textcolor{comment}{//\ precision\ -\/-\/\ length\ -\/-\/\ of\ the\ polynomial}}
\DoxyCodeLine{00020\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \mbox{\hyperlink{polym_8h_adaf590cd5aa3e5808843ac00d9e26d1e}{Max\_Dense}};\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ performance:\ max\ size\ of\ dense\ matrix}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{comment}{//\ ofstream\ \ \ \ output("{}poly.txt"{});\ \ \ \ \ //\ performance:\ intermediate\ output}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ static\ \ \ WMatrix\ \ \ \ \ Poly;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ the\ container\ for\ the\ characteristic\ polynomial}}
\DoxyCodeLine{00024\ \mbox{\hyperlink{lite2_8h_aa4c05e4e478804f6d0fe30b06abe0099}{WMatrix}}\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ container\ for\ the\ characteristic\ polynomial}}
\DoxyCodeLine{00025\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ symmetric;\ \ \textcolor{comment}{//\ don't\ assume\ symmetry\ of\ the\ original\ matrix}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{comment}{/*\ InitPoly}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ *\ determines\ the\ size\ of\ the\ polynomial\ to\ be\ computed,\ given\ user's\ requests:}}
\DoxyCodeLine{00029\ \textcolor{comment}{\ *\ precis\ -\/-\/\ desired\ length\ of\ the\ characteristic\ polynomial;}}
\DoxyCodeLine{00030\ \textcolor{comment}{\ *\ dim\ -\/-\/\ dimension\ of\ the\ spatial\ weights\ matrix.}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ *\ Initializes\ static\ variable\ Poly\ that\ will\ contain\ computed\ polynomial.}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00033\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_ac00d641cff83a1cfaf4c477c5e645a43}{InitPoly}}(\textcolor{keywordtype}{int}\ precis,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ dim)\ \{}
\DoxyCodeLine{00034\ \ \ \textcolor{keywordflow}{if}\ (precis\ <=\ \mbox{\hyperlink{polym_8h_a089c2e12eb41c55e339649240bb94c51}{SL\_SMALL\_MATRIX}})\ precis\ =\ \mbox{\hyperlink{polym_8h_a089c2e12eb41c55e339649240bb94c51}{SL\_SMALL\_MATRIX}}\ +\ 1;\ \ \textcolor{comment}{//\ smaller\ precision\ is\ possible\ but\ who\ needs\ it?}}
\DoxyCodeLine{00035\ \ \ \textcolor{keywordflow}{if}\ (precis\ \%\ 2\ ==\ 0)\ -\/-\/precis;\ \ \ \ \ \ \ \textcolor{comment}{//\ use\ odd\ numbers\ only,\ because\ last\ power\ stored\ must\ be\ even}}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{if}\ (dim\ <\ precis)\ precis\ =\ dim\ +\ 1;\ \ \textcolor{comment}{//\ complete\ characteristic\ polynomial\ has\ only\ dim+1\ coefficients}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ save\ results\ in\ static\ variables}}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{polym_8h_a5b5a395141319c5c13666a272aa1f645}{SL\_Max\_Precision}}\ =\ precis;\ \ \textcolor{comment}{//\ precision\ that\ the\ polynomials\ will\ be\ truncated\ to}}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{polym_8h_adaf590cd5aa3e5808843ac00d9e26d1e}{Max\_Dense}}\ =\ 0;}
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}.clear();}
\DoxyCodeLine{00042\ \ \ symmetric\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}.alloc(dim);\ \ \textcolor{comment}{//\ initialize\ the\ result}}
\DoxyCodeLine{00044\ \};}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{comment}{/*}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ \ \ \ \ \ \ \ PermuteMatrix}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00049\ \textcolor{comment}{//\ template\ <class\ R>}}
\DoxyCodeLine{00050\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a87f716874abb180365d6bf75211e6b35}{PermuteMatrix}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ i,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ j)\ \{}
\DoxyCodeLine{00051\ \ \ mt[i].Swap(mt[j]);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ exchange\ i\ and\ j\ rows}}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{for}\ (;\ mt;\ ++mt)\ \{}
\DoxyCodeLine{00053\ \ \ \ \ std::swap((*mt)[i],\ (*mt)[j]);\ \ \textcolor{comment}{//\ exchange\ i\ and\ j\ columns}}
\DoxyCodeLine{00054\ \ \ \}}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00056\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{comment}{/*}}
\DoxyCodeLine{00059\ \textcolor{comment}{\ \ \ \ \ \ \ \ DanilevskyPostMultiply}}
\DoxyCodeLine{00060\ \textcolor{comment}{Multiplies\ matrix\ mt\ by\ a\ matrix\ that\ is\ different\ from\ I}}
\DoxyCodeLine{00061\ \textcolor{comment}{by\ a\ single\ row\ and\ reduces\ last\ row\ of\ mt\ to\ that\ of\ Frobenius}}
\DoxyCodeLine{00062\ \textcolor{comment}{form.}}
\DoxyCodeLine{00063\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00064\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_aaf7ad0bef23a96c5645d722c41349b63}{DanilevskyPostMultiply}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ r1,\ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ its)\ \{}
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ it,\ itr;}
\DoxyCodeLine{00066\ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ Row,\ Pivot\ =\ its[r1];}
\DoxyCodeLine{00067\ \ \ \textcolor{keywordflow}{for}\ (;\ mt;\ ++mt)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ it((*mt).first(),\ r1);\ \ \textcolor{comment}{//\ limit\ to\ 1st\ r1\ elements}}
\DoxyCodeLine{00069\ \ \ \ \ Row\ =\ it[r1]\ /\ Pivot;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ pivot\ for\ the\ row}}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{if}\ (Row\ !=\ 0)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skip\ iteration\ if\ trivial\ transform}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ itr\ =\ its;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ itr\ is\ modifying\ row}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ it;\ ++it)\ (*it)\ -\/=\ Row\ *\ (*itr++);}
\DoxyCodeLine{00073\ \ \ \ \ \ \ *it++\ =\ Row;\ \ \textcolor{comment}{//\ (r1+1)th\ will\ be\ the\ Row\ pivot}}
\DoxyCodeLine{00074\ \ \ \ \ \ \ ++itr;}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ itr;\ ++itr)\ \ \textcolor{comment}{//\ do\ the\ rest\ elements\ of\ the\ row}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ (*it++)\ -\/=\ Row\ *\ (*itr);}
\DoxyCodeLine{00077\ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \}}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \textcolor{comment}{/*}}
\DoxyCodeLine{00083\ \textcolor{comment}{\ \ \ \ \ \ \ \ DanilevskyPreMultiply}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00085\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a8b8dd531fc557cdb257d21b688f964bd}{DanilevskyPreMultiply}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ r1,\ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ its)\ \{}
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ row1(its.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}(),\ 0);}
\DoxyCodeLine{00087\ \ \ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ it,\ itr;}
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ Row;}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{for}\ (;\ mt;\ ++mt)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ Row\ =\ *its++;}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{if}\ (Row\ !=\ 0)\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (it\ =\ (*mt)(),\ itr\ =\ row1();\ it;\ ++it)\ (*itr++)\ +=\ *it\ *\ Row;}
\DoxyCodeLine{00093\ \ \ \ \ \}}
\DoxyCodeLine{00094\ \ \ \}}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{for}\ (itr\ =\ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}(row1.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}()\ +\ r1);\ its;\ ++its)\ \{}
\DoxyCodeLine{00096\ \ \ \ \ (*itr++)\ +=\ *its;}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ \ \ -\/-\/mt;}
\DoxyCodeLine{00099\ \ \ row1.\mbox{\hyperlink{class_vector_a3cd35c20c654363bb9e0c3ea77f977e0}{Swap}}(*mt);}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00101\ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_abaab16ef4c9c80a1f8ebb2b96a75dbb4}{RemoveColumns}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ num)\ \{}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{for}\ (;\ mt;\ ++mt)\ (*mt)\ -\/=\ num;}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00106\ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \textcolor{comment}{/*}}
\DoxyCodeLine{00109\ \textcolor{comment}{\ \ \ \ \ \ \ \ Danilevsky\ Iteration}}
\DoxyCodeLine{00110\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00111\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_ac1050cf28402f4b026fa097f83d71dcc}{DanilevskyIteration}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ r1,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Remove)\ \{}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordflow}{if}\ (Remove)\ \mbox{\hyperlink{polym_8h_abaab16ef4c9c80a1f8ebb2b96a75dbb4}{RemoveColumns}}(mt,\ Remove);}
\DoxyCodeLine{00113\ \ \ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ itsave(mt[r1\ +\ 1]());}
\DoxyCodeLine{00114\ \ \ mt.\mbox{\hyperlink{class_iterator_ac81b3dc4eacb59190c89be0b145bd1f3}{deflate}}();}
\DoxyCodeLine{00115\ \ \ \mbox{\hyperlink{polym_8h_aaf7ad0bef23a96c5645d722c41349b63}{DanilevskyPostMultiply}}(mt,\ r1,\ itsave);}
\DoxyCodeLine{00116\ \ \ \mbox{\hyperlink{polym_8h_a8b8dd531fc557cdb257d21b688f964bd}{DanilevskyPreMultiply}}(mt,\ r1,\ itsave);}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00118\ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{comment}{/*}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ \ \ \ \ \ \ \ FindAbsLargest}}
\DoxyCodeLine{00122\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00123\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00124\ \textcolor{keyword}{inline}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \mbox{\hyperlink{polym_8h_ad9ba6ebe14958c3efb4c2b996508f97f}{FindAbsLargest}}(\mbox{\hyperlink{class_iterator}{Iterator<R>}}\ vt,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ ro)\ \{}
\DoxyCodeLine{00125\ \ \ R\ init\ =\ *vt;}
\DoxyCodeLine{00126\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ initx(0),\ ix(0);}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordflow}{while}\ (++ix\ <=\ ro)\ \{}
\DoxyCodeLine{00128\ \ \ \ \ ++vt;}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{if}\ (fabs(*vt)\ >\ init)\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ init\ =\ fabs(*vt);}
\DoxyCodeLine{00131\ \ \ \ \ \ \ initx\ =\ ix;}
\DoxyCodeLine{00132\ \ \ \ \ \};}
\DoxyCodeLine{00133\ \ \ \};}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordflow}{return}\ initx;}
\DoxyCodeLine{00135\ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \textcolor{comment}{/*}}
\DoxyCodeLine{00138\ \textcolor{comment}{\ \ \ \ \ \ \ \ PolyMultiply}}
\DoxyCodeLine{00139\ \textcolor{comment}{c\ is\ a\ product\ of\ two\ polynomials,\ determined\ by\ a\ and\ b.}}
\DoxyCodeLine{00140\ \textcolor{comment}{a\ is\ a\ polynomial\ (including\ leading\ 1);}}
\DoxyCodeLine{00141\ \textcolor{comment}{The\ second\ polynomial\ is\ \{1,\ -\/b\}.}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00143\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a0550030e6569c967036f184a62cac73b}{PolyMultiply}}(\mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ \&a,\ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ b,\ \mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ \&c)\ \{}
\DoxyCodeLine{00144\ \ \ c.\mbox{\hyperlink{class_vector_a864d1f7b69f57a633f3b248fad3619ee}{alloc}}(a.\mbox{\hyperlink{class_vector_af45f4326d063c568d21181d0d5738838}{count}}()\ +\ b.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}());}
\DoxyCodeLine{00145\ \ \ \mbox{\hyperlink{lite2_8h_acfc62f638d7f256178130be948c921f6}{Copy}}(c,\ a());}
\DoxyCodeLine{00146\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ cp\ =\ b.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();\ cp;\ -\/-\/cp)\ c\ <<\ 0;}
\DoxyCodeLine{00147\ \ \ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ ita\ =\ a(),\ itr\ =\ c(),\ itr2,\ itb;}
\DoxyCodeLine{00148\ \ \ ++itr;}
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{for}\ (;\ ita;\ ++ita,\ ++itr)\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ vita\ =\ *ita;}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{if}\ (vita\ !=\ 0)}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (itb\ =\ b,\ itr2\ =\ itr;\ itb;\ ++itb)\ *itr2++\ -\/=\ vita\ *\ (*itb);}
\DoxyCodeLine{00153\ \ \ \};}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00155\ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \textcolor{comment}{/*}}
\DoxyCodeLine{00158\ \textcolor{comment}{\ \ \ \ \ \ \ \ Danilevsky\ Method}}
\DoxyCodeLine{00159\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00160\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_abfd9cf31ddb10022112d36489207fab7}{DanilevskyMethod}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ mt,\ \mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ \&poly)\ \{}
\DoxyCodeLine{00161\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ Dsmall\ =\ 0.001;}
\DoxyCodeLine{00162\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}(),\ col,\ ro\ =\ dim,\ C2Remove\ =\ 0;}
\DoxyCodeLine{00163\ \ \ \mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ tpoly(1,\ 1),\ tp;}
\DoxyCodeLine{00164\ \ \ \textcolor{comment}{//\ \ PrintM(mt);}}
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{while}\ (-\/-\/ro)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{if}\ (fabs(mt[ro][ro\ -\/\ 1])\ >\ Dsmall)\ \{\ \ \textcolor{comment}{//\ regular\ iteration}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_ac1050cf28402f4b026fa097f83d71dcc}{DanilevskyIteration}}(mt,\ ro\ -\/\ 1,\ C2Remove);}
\DoxyCodeLine{00168\ \ \ \ \ \ \ C2Remove\ =\ 0;}
\DoxyCodeLine{00169\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \textcolor{comment}{//\ permute\ \&\ iterate}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ col\ =\ \mbox{\hyperlink{polym_8h_ad9ba6ebe14958c3efb4c2b996508f97f}{FindAbsLargest}}(mt[ro](),\ ro\ -\/\ 1);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mt[ro][col]\ !=\ 0)\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_a87f716874abb180365d6bf75211e6b35}{PermuteMatrix}}(mt,\ col,\ ro\ -\/\ 1);}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_ac1050cf28402f4b026fa097f83d71dcc}{DanilevskyIteration}}(mt,\ ro\ -\/\ 1,\ C2Remove);}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ C2Remove\ =\ 0;}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ tp\ =\ tpoly;}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_a0550030e6569c967036f184a62cac73b}{PolyMultiply}}(tp,\ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}(\&mt[ro][ro],\ dim\ -\/\ ro),\ tpoly);}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ C2Remove\ +=\ dim\ -\/\ ro;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ dim\ =\ ro;}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00181\ \ \ \ \ \};}
\DoxyCodeLine{00182\ \ \ \ \ mt.\mbox{\hyperlink{class_iterator_ac81b3dc4eacb59190c89be0b145bd1f3}{deflate}}();}
\DoxyCodeLine{00183\ \ \ \};}
\DoxyCodeLine{00184\ \ \ \mbox{\hyperlink{polym_8h_a0550030e6569c967036f184a62cac73b}{PolyMultiply}}(tpoly,\ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}(mt[0].first(),\ dim),\ poly);}
\DoxyCodeLine{00185\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00186\ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{comment}{/*}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ \ \ \ \ \ \ \ LevelStructure}}
\DoxyCodeLine{00190\ \textcolor{comment}{Assumes\ order\ has\ dim(mt)+1\ in\ all\ its\ elements.}}
\DoxyCodeLine{00191\ \textcolor{comment}{On\ the\ exit:\ perm\ -\/-\/\ contains\ the\ ordering,}}
\DoxyCodeLine{00192\ \textcolor{comment}{order\ -\/-\/\ contains\ contiguity\ order\ (0,1,2,...)\ for\ each\ block}}
\DoxyCodeLine{00193\ \textcolor{comment}{sequence\ is\ determined\ by\ perm;}}
\DoxyCodeLine{00194\ \textcolor{comment}{start\ -\/-\/\ the\ pseudoperipheral;}}
\DoxyCodeLine{00195\ \textcolor{comment}{Contig\ -\/-\/\ length\ of\ the\ levelstructure\ (if\ single\ block);}}
\DoxyCodeLine{00196\ \textcolor{comment}{returns\ the\ number\ of\ blocks.}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00198\ \textcolor{comment}{//\ template\ <class\ M>}}
\DoxyCodeLine{00199\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \mbox{\hyperlink{polym_8h_a622cc3d52b0eb88a1045e15a4d0ae04a}{LevelStructure}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \&start,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \&Contig,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_iterator}{Iterator<INDEX>}}\ perm,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ *order)\ \{}
\DoxyCodeLine{00200\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_vector_a12449554072b5e05998c3e5607dcc2e3}{WMap::input\_iterator}}\ iROW;}
\DoxyCodeLine{00201\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Dim1\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}()\ +\ 1,\ conty(0),\ pieces(0),\ init(start);}
\DoxyCodeLine{00202\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ *first,\ *last,\ *current,\ *next;}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ next\ =\ perm();}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00206\ \ \ \ \ order[init]\ =\ 0;}
\DoxyCodeLine{00207\ \ \ \ \ ++pieces;}
\DoxyCodeLine{00208\ \ \ \ \ last\ =\ next++;}
\DoxyCodeLine{00209\ \ \ \ \ *last\ =\ init;}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ first\ =\ last;}
\DoxyCodeLine{00212\ \ \ \ \ \ \ last\ =\ next;}
\DoxyCodeLine{00213\ \ \ \ \ \ \ ++conty;}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (current\ =\ first;\ current\ <\ last;\ ++current)}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (iROW\ r\ =\ mt[*current]();\ r;\ ++r)\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ tid\ =\ (*r).first;}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (order[tid]\ ==\ Dim1)\ order[(*next++)\ =\ tid]\ =\ conty;}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00219\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (last\ !=\ next);\ \ \textcolor{comment}{//\ no\ new\ elements\ added\ to\ permutation\ table}}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{if}\ (next\ <=\ perm.\mbox{\hyperlink{class_iterator_a6aee1057c202f255a23a0b841ab16e44}{last}}())}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (order[init]\ <\ Dim1)\ ++init;}
\DoxyCodeLine{00222\ \ \ \}\ \textcolor{keywordflow}{while}\ (next\ <=\ perm.\mbox{\hyperlink{class_iterator_a6aee1057c202f255a23a0b841ab16e44}{last}}());}
\DoxyCodeLine{00223\ \ \ order[init]\ =\ 0;\ \ \ \ \textcolor{comment}{//\ mark\ the\ last\ element}}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{if}\ (pieces\ ==\ 1)\ \{\ \ \textcolor{comment}{//\ find\ element\ with\ min\ degree}}
\DoxyCodeLine{00225\ \ \ \ \ init\ =\ Dim1;}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{comment}{//\ \ \ \ cout\ <<\ "{}ordering\ "{}\ <<\ std::setw(4)\ <<\ mt.count()\ <<\ "{}\ \ elts,\ \ conty:\ "{}\ <<\ std::setw(4)\ <<\ conty\ <<\ "{}\ \ has\ "{}}}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{comment}{//\ \ \ \ <<\ last-\/first\ <<\ std::endl;}}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{keywordflow}{for}\ (current\ =\ first;\ current\ <\ last;\ ++current)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ cnt\ =\ mt[*current].\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cnt\ <\ init)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ init\ =\ cnt;}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ next\ =\ current;}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00234\ \ \ \ \ \};}
\DoxyCodeLine{00235\ \ \ \};}
\DoxyCodeLine{00236\ \ \ Contig\ =\ conty;}
\DoxyCodeLine{00237\ \ \ start\ =\ next\ -\/\ perm();}
\DoxyCodeLine{00238\ \ \ \textcolor{keywordflow}{return}\ pieces;}
\DoxyCodeLine{00239\ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \textcolor{comment}{/*}}
\DoxyCodeLine{00242\ \textcolor{comment}{\ \ \ \ \ \ \ \ PolyProduct}}
\DoxyCodeLine{00243\ \textcolor{comment}{}}
\DoxyCodeLine{00244\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00245\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ P>}
\DoxyCodeLine{00246\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a1d686219b28c3765fec487a853f105a0}{PolyProduct}}(\mbox{\hyperlink{class_vector}{Vector<P>}}\ \&v1,\ \mbox{\hyperlink{class_iterator}{Iterator<P>}}\ v2)\ \{}
\DoxyCodeLine{00247\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<P>}}\ it2;}
\DoxyCodeLine{00248\ \ \ \mbox{\hyperlink{class_short_iterator}{ShortIterator<P>}}\ it1(v1.\mbox{\hyperlink{class_vector_ae5041c136faabeccd5ed9f519c9f4e80}{last}}()),\ First,\ work;}
\DoxyCodeLine{00249\ \ \ P\ Current;}
\DoxyCodeLine{00250\ \ \ \textcolor{keywordtype}{bool}\ Restricted\ =\ 0;}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordtype}{size\_t}\ Add\ =\ v2.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}()\ -\/\ 1,\ AddRestricted\ =\ v1.\mbox{\hyperlink{class_vector_a9b439586cd10cb45d002ca9d6e3db43c}{size}}()\ -\/\ v1.\mbox{\hyperlink{class_vector_af45f4326d063c568d21181d0d5738838}{count}}();}
\DoxyCodeLine{00252\ \ \ \textcolor{keywordflow}{if}\ (Add\ >\ AddRestricted)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ Restricted\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00254\ \ \ \ \ Add\ =\ AddRestricted;}
\DoxyCodeLine{00255\ \ \ \};}
\DoxyCodeLine{00256\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ AddIn\ =\ 0;\ AddIn\ <\ Add;\ ++AddIn)\ \ \textcolor{comment}{//\ adds\ Add\ zeros\ to\ the\ vector}}
\DoxyCodeLine{00257\ \ \ \ \ v1\ <<\ 0;}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \textcolor{keywordflow}{if}\ (Restricted)\ \{}
\DoxyCodeLine{00260\ \ \ \ \ ++Add;}
\DoxyCodeLine{00261\ \ \ \ \ First\ =\ \mbox{\hyperlink{class_short_iterator}{ShortIterator<P>}}(it1()\ -\/\ v2.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}()\ +\ Add);}
\DoxyCodeLine{00262\ \ \ \ \ v2\ =\ \mbox{\hyperlink{class_iterator}{Iterator<P>}}(v2.\mbox{\hyperlink{class_iterator_a6e5276437e645efc8da75c4609fdff5b}{first}}(),\ Add);}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ First\ <\ it1;\ -\/-\/it1)\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((Current\ =\ *it1)\ !=\ 0)}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (*it1\ =\ 0,\ it2\ =\ v2,\ work\ =\ it1;\ it2;\ ++it2)\ (*work++)\ +=\ *it2\ *\ Current;}
\DoxyCodeLine{00266\ \ \ \ \ \ \ v2.\mbox{\hyperlink{class_iterator_afa5c45d65e59fc5c643d796997444071}{inflate}}();}
\DoxyCodeLine{00267\ \ \ \ \ \};}
\DoxyCodeLine{00268\ \ \ \};}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ First\ =\ \mbox{\hyperlink{class_short_iterator}{ShortIterator<P>}}(v1.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}());}
\DoxyCodeLine{00271\ \ \ \textcolor{keywordflow}{for}\ (;\ !(it1\ <\ First);\ -\/-\/it1)}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keywordflow}{for}\ (Current\ =\ *it1,\ *it1\ =\ 0,\ it2\ =\ v2,\ work\ =\ it1;\ it2;\ ++it2)\ (*work++)\ +=\ *it2\ *\ Current;}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00275\ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \textcolor{comment}{/*}}
\DoxyCodeLine{00278\ \textcolor{comment}{\ \ \ \ \ \ \ \ SparseSubMatrix}}
\DoxyCodeLine{00279\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00280\ \textcolor{comment}{//\ template\ <class\ R>}}
\DoxyCodeLine{00281\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a32c764c7c1a9272f0bdbc0a730225ba2}{SparseSubMatrix}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \mbox{\hyperlink{class_iterator}{Iterator<INDEX>}}\ perm,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ *flag,\ \mbox{\hyperlink{class_vector}{Vector<WMap>}}\ \&v)\ \{}
\DoxyCodeLine{00282\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Length\ =\ 0,\ *IxPerm\ =\ perm(),\ FlagId\ =\ flag[*perm];}
\DoxyCodeLine{00283\ \ \ \mbox{\hyperlink{class_vector}{Vector<INDEX>}}\ InversePermute(mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}());}
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{while}\ (perm\ \&\&\ flag[*perm]\ ==\ FlagId)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ InversePermute[*perm++]\ =\ Length;}
\DoxyCodeLine{00286\ \ \ \ \ ++Length;}
\DoxyCodeLine{00287\ \ \ \};}
\DoxyCodeLine{00288\ \ \ v.\mbox{\hyperlink{class_vector_a864d1f7b69f57a633f3b248fad3619ee}{alloc}}(Length);}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \textcolor{keywordflow}{for}\ (;\ v;\ ++v)\ \{}
\DoxyCodeLine{00291\ \ \ \ \ \mbox{\hyperlink{class_vector_a12449554072b5e05998c3e5607dcc2e3}{WMap::input\_iterator}}\ OneRow\ =\ mt[*IxPerm++]();}
\DoxyCodeLine{00292\ \ \ \ \ (*v).alloc(OneRow.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}());}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ OneRow;\ ++OneRow)}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flag[(*OneRow).first]\ ==\ FlagId)\ *v\ <<\ \mbox{\hyperlink{class_short_iterator_a53ec66291ce2b7e582be864a5904be33}{WMap::data}}(InversePermute[(*OneRow).first],\ (*OneRow).second);}
\DoxyCodeLine{00295\ \ \ \};}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00297\ \}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ IR>}
\DoxyCodeLine{00300\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a4d2ea91dbbf3520a912c32eeb411c68d}{SavePerm}}(\mbox{\hyperlink{class_iterator}{Iterator<IR>}}\ it,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ *perm)\ \{}
\DoxyCodeLine{00301\ \ \ \textcolor{keywordflow}{for}\ (;\ it;\ ++it)\ (*it).first\ =\ perm[(*it).first];}
\DoxyCodeLine{00302\ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \textcolor{comment}{/*}}
\DoxyCodeLine{00305\ \textcolor{comment}{\ \ \ \ \ \ \ \ Rename}}
\DoxyCodeLine{00306\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00307\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ R>}
\DoxyCodeLine{00308\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_aeb5dc3aae4617b1ecd855c54d6d10565}{Rename}}(\mbox{\hyperlink{class_iterator}{Iterator<R>}}\ mt,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ *Perm)\ \{}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_iterator}{Iterator<R>}}\ it\ =\ mt;\ it;\ ++it)\ \{}
\DoxyCodeLine{00310\ \ \ \ \ \mbox{\hyperlink{polym_8h_a4d2ea91dbbf3520a912c32eeb411c68d}{SavePerm}}((*it)(),\ Perm);}
\DoxyCodeLine{00311\ \ \ \ \ \mbox{\hyperlink{lite2_8h_a296bbd8b511d9d0ec7e41b6203569c0d}{HeapSort}}((*it)());}
\DoxyCodeLine{00312\ \ \ \}}
\DoxyCodeLine{00313\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}(),\ IxOld,\ IxNew;}
\DoxyCodeLine{00314\ \ \ \textcolor{keywordflow}{for}\ (IxOld\ =\ 0;\ IxOld\ <\ Dim;\ ++IxOld)\ \{}
\DoxyCodeLine{00315\ \ \ \ \ IxNew\ =\ Perm[IxOld];}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordflow}{while}\ (IxOld\ !=\ IxNew)\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \ \ mt[IxNew].Swap(mt[IxOld]);}
\DoxyCodeLine{00318\ \ \ \ \ \ \ std::swap(IxNew,\ Perm[IxNew]);}
\DoxyCodeLine{00319\ \ \ \ \ \}}
\DoxyCodeLine{00320\ \ \ \};}
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00322\ \}}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \textcolor{comment}{/*}}
\DoxyCodeLine{00325\ \textcolor{comment}{\ \ \ \ \ \ \ \ SelectMatrix}}
\DoxyCodeLine{00326\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00327\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a783f3ad2f22a8ea86604fae069d4f28a}{SelectMatrix}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ start,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ stop,\ \mbox{\hyperlink{class_vector}{Vector<WMap>}}\ \&v)\ \{}
\DoxyCodeLine{00328\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ it(mt.\mbox{\hyperlink{class_iterator_a6e5276437e645efc8da75c4609fdff5b}{first}}()\ +\ start,\ stop\ -\/\ start);}
\DoxyCodeLine{00329\ \ \ v.\mbox{\hyperlink{class_vector_a864d1f7b69f57a633f3b248fad3619ee}{alloc}}(stop\ -\/\ start);}
\DoxyCodeLine{00330\ \ \ \textcolor{keywordflow}{for}\ (;\ it;\ ++it,\ ++v)\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WPair>}}\ itr\ =\ (*it)();}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordflow}{while}\ (itr\ \&\&\ (*itr).\mbox{\hyperlink{class_iterator_a6e5276437e645efc8da75c4609fdff5b}{first}}\ <\ start)\ ++itr;}
\DoxyCodeLine{00333\ \ \ \ \ (*v).alloc(itr.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}());}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordflow}{while}\ (itr\ \&\&\ (*itr).\mbox{\hyperlink{class_iterator_a6e5276437e645efc8da75c4609fdff5b}{first}}\ <\ stop)\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ *v\ <<\ \mbox{\hyperlink{lite2_8h_aa5cc9c44184affabe7dbac94d90f2854}{WPair}}((*itr).first\ -\/\ start,\ (*itr).second);}
\DoxyCodeLine{00336\ \ \ \ \ \ \ ++itr;}
\DoxyCodeLine{00337\ \ \ \ \ \};}
\DoxyCodeLine{00338\ \ \ \};}
\DoxyCodeLine{00339\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00340\ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \textcolor{comment}{/*}}
\DoxyCodeLine{00343\ \textcolor{comment}{\ \ \ \ \ \ \ \ RemoveTheBelt}}
\DoxyCodeLine{00344\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00345\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_ab41c635f92197ad9d125952a4ae94090}{RemoveTheBelt}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ it,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ InTheBelt)\ \{}
\DoxyCodeLine{00346\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Limit\ =\ 0;}
\DoxyCodeLine{00347\ \ \ \textcolor{keywordflow}{for}\ (;\ it;\ ++it)\ \{\ \ \textcolor{comment}{//\ truncate\ the\ belt\ from\ the\ weights\ matrix}}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keywordflow}{if}\ (InTheBelt\ <\ Limit)\ ++InTheBelt;}
\DoxyCodeLine{00349\ \ \ \ \ ++Limit;}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{while}\ (!(*it).empty())\ \{}
\DoxyCodeLine{00351\ \ \ \ \ \ \ -\/-\/(*it);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*(*it)).first\ <\ InTheBelt)\ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ ++(*it);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00356\ \ \ \ \ \};}
\DoxyCodeLine{00357\ \ \ \};}
\DoxyCodeLine{00358\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00359\ \}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \textcolor{comment}{/*}}
\DoxyCodeLine{00362\ \textcolor{comment}{\ \ \ \ \ \ \ \ SparsePolyBordering}}
\DoxyCodeLine{00363\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00364\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a9dcb8129dd797bc11805632aa33f0d66}{SparsePolyBordering}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ BeltSize,\ \mbox{\hyperlink{lite2_8h_aa4c05e4e478804f6d0fe30b06abe0099}{WMatrix}}\ \&\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})\ \{}
\DoxyCodeLine{00365\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}(),\ InTheBelt\ =\ Dim\ -\/\ BeltSize;}
\DoxyCodeLine{00366\ \ \ \mbox{\hyperlink{polym_8h_ab41c635f92197ad9d125952a4ae94090}{RemoveTheBelt}}(mt,\ InTheBelt);}
\DoxyCodeLine{00367\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ it(mt.\mbox{\hyperlink{class_iterator_a6e5276437e645efc8da75c4609fdff5b}{first}}(),\ InTheBelt);}
\DoxyCodeLine{00368\ \ \ \textcolor{keywordflow}{for}\ (;\ InTheBelt\ <\ Dim;\ ++InTheBelt)\ \{}
\DoxyCodeLine{00369\ \ \ \ \ (*Poly).alloc(\mbox{\hyperlink{lite2_8h_ae57614aa49a6298bfcef92612873e04d}{sl\_min}}(InTheBelt\ +\ 2,\ \mbox{\hyperlink{polym_8h_a5b5a395141319c5c13666a272aa1f645}{SL\_Max\_Precision}}));}
\DoxyCodeLine{00370\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ Diag\ =\ 0;}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordflow}{if}\ (mt[InTheBelt])}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*(mt[InTheBelt])).first\ ==\ InTheBelt)\ Diag\ =\ (*(mt[InTheBelt])).second;}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{if}\ (symmetric)\ \{}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \mbox{\hyperlink{class_power_sym_lag}{PowerSymLag}}\ SparseLag(it,\ InTheBelt);}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ \mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}}\ =\ SparseLag.\mbox{\hyperlink{class_power_sym_lag_ac533476439cd9580fce54d85485810c1}{Init}}();}
\DoxyCodeLine{00376\ \ \ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ 1\ <<\ -\/Diag\ <<\ -\/\mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}};}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (*\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})\ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ -\/SparseLag.\mbox{\hyperlink{class_power_sym_lag_a2ebb74609729a2784ae3abaa59e5c9b6}{ComputeLag}}();}
\DoxyCodeLine{00378\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \textcolor{comment}{//\ matrix\ is\ not\ symmetric,\ yet\ has\ symmetric\ structure}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \mbox{\hyperlink{class_power_lag}{PowerLag}}\ SparseLag(it,\ InTheBelt);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ \mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}}\ =\ SparseLag.\mbox{\hyperlink{class_power_lag_aac78c8b85bf9e9b2cebe0101be5238e5}{Init}}();}
\DoxyCodeLine{00382\ \ \ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ 1\ <<\ -\/Diag\ <<\ -\/\mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}};}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (*\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})\ \{}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}}\ =\ SparseLag.\mbox{\hyperlink{class_power_lag_aba86f6228fe473b73c264c8dc92da290}{ComputeLag}}();}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ -\/\mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}};}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00387\ \ \ \ \ \};}
\DoxyCodeLine{00388\ \ \ \ \ ++\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};}
\DoxyCodeLine{00389\ \ \ \ \ it.\mbox{\hyperlink{class_iterator_afa5c45d65e59fc5c643d796997444071}{inflate}}();}
\DoxyCodeLine{00390\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WPair>}}\ itr\ =\ (*it.\mbox{\hyperlink{class_iterator_a6aee1057c202f255a23a0b841ab16e44}{last}}())();}
\DoxyCodeLine{00391\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ itr;\ ++itr)\ ++it[(*itr).first];}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{keywordflow}{if}\ (Diag)\ ++mt[InTheBelt];}
\DoxyCodeLine{00393\ \ \ \};}
\DoxyCodeLine{00394\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00395\ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \textcolor{comment}{/*}}
\DoxyCodeLine{00398\ \textcolor{comment}{\ \ \ \ \ \ \ \ SparsePolyBordering}}
\DoxyCodeLine{00399\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00400\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_abf8445d3c21621b80fa766845706b935}{SparsePolyBorderingNE}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ BeltSize,\ \mbox{\hyperlink{lite2_8h_aa4c05e4e478804f6d0fe30b06abe0099}{WMatrix}}\ \&\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})\ \{}
\DoxyCodeLine{00401\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();}
\DoxyCodeLine{00402\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ InTheBelt;}
\DoxyCodeLine{00403\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ it\ =\ mt;}
\DoxyCodeLine{00404\ \ \ \textcolor{keywordflow}{for}\ (InTheBelt\ =\ Dim\ -\/\ 1;\ InTheBelt\ >=\ Dim\ -\/\ BeltSize;\ -\/-\/InTheBelt)\ \{}
\DoxyCodeLine{00405\ \ \ \ \ it.\mbox{\hyperlink{class_iterator_ac81b3dc4eacb59190c89be0b145bd1f3}{deflate}}();}
\DoxyCodeLine{00406\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WPair>}}\ itr\ =\ it[InTheBelt]();\ \ \textcolor{comment}{//\ iterate\ over\ the\ just\ bordered\ row}}
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ itr;\ ++itr)\ \{}
\DoxyCodeLine{00408\ \ \ \ \ \ \ -\/-\/it[(*itr).first];\ \ \textcolor{comment}{//\ remove\ these\ elements\ from\ the\ matrix}}
\DoxyCodeLine{00409\ \ \ \ \ \};}
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ if\ (Diag)\ -\/-\/it[InTheBelt];\ \ \ -\/-\/\ don't\ need\ ,\ since\ the\ whole\ row\ goes\ away}}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ it.deflate();\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ remove\ the\ row\ from\ the\ matrix}}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \ \ (*Poly).alloc(\mbox{\hyperlink{lite2_8h_ae57614aa49a6298bfcef92612873e04d}{sl\_min}}(InTheBelt\ +\ 2,\ \mbox{\hyperlink{polym_8h_a5b5a395141319c5c13666a272aa1f645}{SL\_Max\_Precision}}));}
\DoxyCodeLine{00414\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ Diag\ =\ 0;}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{if}\ (mt[InTheBelt])}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*(mt[InTheBelt])).first\ ==\ InTheBelt)\ Diag\ =\ (*(mt[InTheBelt])).second;}
\DoxyCodeLine{00417\ \ \ \ \ \textcolor{keywordflow}{if}\ (symmetric)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \mbox{\hyperlink{class_power_sym_lag}{PowerSymLag}}\ SparseLag(it,\ InTheBelt);}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ \mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}}\ =\ SparseLag.\mbox{\hyperlink{class_power_sym_lag_ac533476439cd9580fce54d85485810c1}{Init}}();}
\DoxyCodeLine{00420\ \ \ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ 1\ <<\ -\/Diag\ <<\ -\/\mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}};}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (*\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})\ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ -\/SparseLag.\mbox{\hyperlink{class_power_sym_lag_a2ebb74609729a2784ae3abaa59e5c9b6}{ComputeLag}}();}
\DoxyCodeLine{00422\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \textcolor{comment}{//\ matrix\ is\ not\ symmetric,\ yet\ has\ symmetric\ structure}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \ \ \mbox{\hyperlink{class_power_lag}{PowerLag}}\ SparseLag(it,\ InTheBelt);}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ \mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}}\ =\ SparseLag.\mbox{\hyperlink{class_power_lag_aac78c8b85bf9e9b2cebe0101be5238e5}{Init}}();}
\DoxyCodeLine{00426\ \ \ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ 1\ <<\ -\/Diag\ <<\ -\/\mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}};}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (*\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}}\ =\ SparseLag.\mbox{\hyperlink{class_power_lag_aba86f6228fe473b73c264c8dc92da290}{ComputeLag}}();}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ -\/\mbox{\hyperlink{smile2_8cpp_a8c05e96c512e86c2fc507220e0b402b0}{Lag}};}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00431\ \ \ \ \ \};}
\DoxyCodeLine{00432\ \ \ \ \ ++\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};}
\DoxyCodeLine{00433\ \ \ \};}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordtype}{int}\ ct\ =\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}.count()\ -\/\ 1;}
\DoxyCodeLine{00435\ \ \ \textcolor{keywordtype}{int}\ cr\ =\ 0;}
\DoxyCodeLine{00436\ \ \ \textcolor{keywordflow}{while}\ (cr\ <\ ct)\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}[cr].Swap(\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}[ct]);}
\DoxyCodeLine{00438\ \ \ \ \ -\/-\/ct;}
\DoxyCodeLine{00439\ \ \ \ \ ++cr;}
\DoxyCodeLine{00440\ \ \ \};}
\DoxyCodeLine{00441\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00442\ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \mbox{\hyperlink{polym_8h_a2f3fd9411da34dd4faa1988983fb1545}{kDenseMax}}\ =\ 1;}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \textcolor{comment}{//\ static\ WMatrix\ \ \ BufferDense;}}
\DoxyCodeLine{00447\ \mbox{\hyperlink{lite2_8h_aa4c05e4e478804f6d0fe30b06abe0099}{WMatrix}}\ \mbox{\hyperlink{polym_8h_aca9b6ff613d988cc22b061d312c6ab34}{BufferDense}};}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \textcolor{comment}{/*}}
\DoxyCodeLine{00450\ \textcolor{comment}{\ \ \ \ \ \ \ \ DensePolySolving}}
\DoxyCodeLine{00451\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00452\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a76bea34d3f14396be8f647b7667fff04}{DensePolySolving}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt)\ \{}
\DoxyCodeLine{00453\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();}
\DoxyCodeLine{00454\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WPair>}}\ itr;}
\DoxyCodeLine{00455\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{polym_8h_adaf590cd5aa3e5808843ac00d9e26d1e}{Max\_Dense}}\ <\ dim)\ \mbox{\hyperlink{polym_8h_adaf590cd5aa3e5808843ac00d9e26d1e}{Max\_Dense}}\ =\ dim;}
\DoxyCodeLine{00456\ \ \ \textcolor{keywordflow}{if}\ (dim\ <=\ 1)\ \{}
\DoxyCodeLine{00457\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ val\ =\ 0;}
\DoxyCodeLine{00458\ \ \ \ \ (*Poly).alloc(2);}
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*mt).empty())\ val\ =\ (*(*mt)).second;}
\DoxyCodeLine{00460\ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ 1\ <<\ -\/val;}
\DoxyCodeLine{00461\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (dim\ <=\ \mbox{\hyperlink{polym_8h_a2f3fd9411da34dd4faa1988983fb1545}{kDenseMax}})\ \{}
\DoxyCodeLine{00462\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ tmp;}
\DoxyCodeLine{00463\ \ \ \ \ \mbox{\hyperlink{polym_8h_aca9b6ff613d988cc22b061d312c6ab34}{BufferDense}}.reset();}
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ mt;\ ++mt,\ ++\mbox{\hyperlink{polym_8h_aca9b6ff613d988cc22b061d312c6ab34}{BufferDense}})\ \{}
\DoxyCodeLine{00465\ \ \ \ \ \ \ (*BufferDense).fill(dim,\ 0);}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (itr\ =\ (*mt)();\ itr;\ ++itr)\ (*\mbox{\hyperlink{polym_8h_aca9b6ff613d988cc22b061d312c6ab34}{BufferDense}})[(*itr).first]\ =\ (*itr).second;}
\DoxyCodeLine{00467\ \ \ \ \ \};}
\DoxyCodeLine{00468\ \ \ \ \ tmp\ =\ \mbox{\hyperlink{polym_8h_aca9b6ff613d988cc22b061d312c6ab34}{BufferDense}}();}
\DoxyCodeLine{00469\ \ \ \ \ \mbox{\hyperlink{polym_8h_abfd9cf31ddb10022112d36489207fab7}{DanilevskyMethod}}(tmp,\ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}});}
\DoxyCodeLine{00470\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00471\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa4c05e4e478804f6d0fe30b06abe0099}{WMatrix}}\ Dense(dim);}
\DoxyCodeLine{00472\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ mt;\ ++mt,\ ++Dense)\ \{}
\DoxyCodeLine{00473\ \ \ \ \ \ \ (*Dense).alloc(dim,\ 0);}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (itr\ =\ (*mt)();\ itr;\ ++itr)\ (*Dense)[(*itr).first]\ =\ (*itr).second;}
\DoxyCodeLine{00475\ \ \ \ \ \};}
\DoxyCodeLine{00476\ \ \ \ \ \mbox{\hyperlink{polym_8h_abfd9cf31ddb10022112d36489207fab7}{DanilevskyMethod}}(Dense(),\ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}});}
\DoxyCodeLine{00477\ \ \ \};}
\DoxyCodeLine{00478\ \ \ ++\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};}
\DoxyCodeLine{00479\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00480\ \};}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \textcolor{comment}{/*}}
\DoxyCodeLine{00483\ \textcolor{comment}{\ \ \ \ \ \ \ \ DensePolySolving\ -\/-\/\ old}}
\DoxyCodeLine{00484\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00485\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_aa07e9b8661f4182f3beaf429619b695d}{DensePolySolvingOld}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt)\ \{}
\DoxyCodeLine{00486\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();}
\DoxyCodeLine{00487\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{polym_8h_adaf590cd5aa3e5808843ac00d9e26d1e}{Max\_Dense}}\ <\ dim)\ \mbox{\hyperlink{polym_8h_adaf590cd5aa3e5808843ac00d9e26d1e}{Max\_Dense}}\ =\ dim;}
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{if}\ (dim\ >\ 1)\ \{}
\DoxyCodeLine{00489\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa4c05e4e478804f6d0fe30b06abe0099}{WMatrix}}\ Dense(dim);}
\DoxyCodeLine{00490\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WPair>}}\ itr;}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ mt;\ ++mt,\ ++Dense)\ \{}
\DoxyCodeLine{00492\ \ \ \ \ \ \ (*Dense).alloc(dim,\ 0);}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (itr\ =\ (*mt)();\ itr;\ ++itr)\ (*Dense)[(*itr).first]\ =\ (*itr).second;}
\DoxyCodeLine{00494\ \ \ \ \ \};}
\DoxyCodeLine{00495\ \ \ \ \ \mbox{\hyperlink{polym_8h_abfd9cf31ddb10022112d36489207fab7}{DanilevskyMethod}}(Dense(),\ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}});}
\DoxyCodeLine{00496\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ val\ =\ 0;}
\DoxyCodeLine{00498\ \ \ \ \ (*Poly).alloc(2);}
\DoxyCodeLine{00499\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*mt).empty())\ val\ =\ (*(*mt)).second;}
\DoxyCodeLine{00500\ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ <<\ 1\ <<\ -\/val;}
\DoxyCodeLine{00501\ \ \ \};}
\DoxyCodeLine{00502\ \ \ ++\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00504\ \};}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \textcolor{comment}{//**********************************************************}}
\DoxyCodeLine{00507\ \textcolor{comment}{//\ \ \ \ \ \ \ \ PolyOrganize}}
\DoxyCodeLine{00508\ \textcolor{comment}{//**********************************************************}}
\DoxyCodeLine{00509\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a1369c7b447e333a1a3198034b1b7b355}{PolyOrganize}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ *First,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Precision,\ \mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ Border)\ \{}
\DoxyCodeLine{00510\ \ \ \textcolor{keywordflow}{if}\ (Precision\ <\ \mbox{\hyperlink{polym_8h_a5b5a395141319c5c13666a272aa1f645}{SL\_Max\_Precision}})\ \{}
\DoxyCodeLine{00511\ \ \ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Cnt\ =\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}.last()\ +\ 1\ -\/\ First;}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordflow}{if}\ (Cnt\ >\ 1)\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ acc(Precision);}
\DoxyCodeLine{00514\ \ \ \ \ \ \ acc\ <<\ 1;}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (Cnt-\/-\/\ >\ 0)\ \{}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ -\/-\/\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_a1d686219b28c3765fec487a853f105a0}{PolyProduct}}(acc,\ (*\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})());}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ (*Poly).clear();}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00520\ \ \ \ \ \ \ (*Poly).\mbox{\hyperlink{class_vector_a3cd35c20c654363bb9e0c3ea77f977e0}{Swap}}(acc);}
\DoxyCodeLine{00521\ \ \ \ \ \};}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordflow}{while}\ (Border\ \&\&\ (*Border).\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}()\ <\ \mbox{\hyperlink{polym_8h_a5b5a395141319c5c13666a272aa1f645}{SL\_Max\_Precision}})\ \{}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ std::cout\ <<\ "{}\ org:\ "{}\ <<\ (*Border).count()\ <<\ "{}\ +\ "{}\ <<\ (*Poly).count()\ <<\ std::endl;}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_a1d686219b28c3765fec487a853f105a0}{PolyProduct}}(*Border,\ (*\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})());}
\DoxyCodeLine{00526\ \ \ \ \ \ \ (*Poly).destroy();}
\DoxyCodeLine{00527\ \ \ \ \ \ \ (*Poly).Swap(*Border);}
\DoxyCodeLine{00528\ \ \ \ \ \ \ ++Border;}
\DoxyCodeLine{00529\ \ \ \ \ \};}
\DoxyCodeLine{00530\ \ \ \ \ ++\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};}
\DoxyCodeLine{00531\ \ \ \};}
\DoxyCodeLine{00532\ \ \ \textcolor{keywordflow}{for}\ (;\ Border;\ ++Border,\ ++\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}})\ \{}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{comment}{//\ \ \ \ cout\ <<\ "{}\ org,\ copy:\ "{}\ <<\ (*Border).count()\ <<\ std::endl;}}
\DoxyCodeLine{00534\ \ \ \ \ *\mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}\ =\ *Border;}
\DoxyCodeLine{00535\ \ \ \};}
\DoxyCodeLine{00536\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00537\ \};}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \mbox{\hyperlink{polym_8h_a7a5c04884939f8a9c40e2e0cab172486}{SplitSparse}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Pseudo,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \&Second,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \&PseudoCount)\ \{}
\DoxyCodeLine{00540\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();}
\DoxyCodeLine{00541\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ n1,\ n2\ =\ 1,\ StartBest\ =\ 0,\ localLevel,\ oldPseudo;}
\DoxyCodeLine{00542\ \ \ \mbox{\hyperlink{class_vector}{Vector<INDEX>}}\ perm(dim,\ 0),\ order(dim);}
\DoxyCodeLine{00543\ \ \ \textcolor{comment}{//\ find\ pseudoperipheral}}
\DoxyCodeLine{00544\ \ \ \textcolor{comment}{//\ \ cout\ <<\ "{}ps:\ "{}\ <<\ Pseudo\ <<\ "{}\ \ level:\ "{}\ <<\ Level;}}
\DoxyCodeLine{00545\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keywordflow}{for}\ (n1\ =\ 0;\ n1\ <\ dim;\ ++n1)\ order[n1]\ =\ dim\ +\ 1;}
\DoxyCodeLine{00547\ \ \ \ \ oldPseudo\ =\ Pseudo;}
\DoxyCodeLine{00548\ \ \ \ \ \mbox{\hyperlink{polym_8h_a622cc3d52b0eb88a1045e15a4d0ae04a}{LevelStructure}}(mt,\ Pseudo,\ localLevel,\ perm(),\ order.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}());}
\DoxyCodeLine{00549\ \ \ \}\ \textcolor{keywordflow}{while}\ (oldPseudo\ ==\ 0);}
\DoxyCodeLine{00550\ \ \ \textcolor{comment}{//\ \ \ cout\ <<\ "{}\ \ psF:\ "{}\ <<\ Pseudo\ <<\ "{}\ \ levelF:\ "{}\ <<\ Level\ <<\ std::endl;}}
\DoxyCodeLine{00551\ }
\DoxyCodeLine{00552\ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ OpBest\ =\ dim\ *\ \mbox{\hyperlink{polym_8h_ac9308e85a1e9abba7f247485552bb3ef}{geoda\_sqr}}((\textcolor{keywordtype}{double})dim),\ OpLevel;}
\DoxyCodeLine{00553\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ lev\ =\ 1;\ lev\ <\ localLevel\ -\/\ 1;\ ++lev)\ \{}
\DoxyCodeLine{00554\ \ \ \ \ n1\ =\ n2;}
\DoxyCodeLine{00555\ \ \ \ \ \textcolor{keywordflow}{while}\ (order[perm[n2]]\ ==\ lev)\ ++n2;}
\DoxyCodeLine{00556\ \ \ \ \ OpLevel\ =\ (n2\ -\/\ n1)\ *\ dim;}
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keywordflow}{if}\ (dim\ <\ 300)\ OpLevel\ *=\ 2;\ \ \textcolor{comment}{//\ adjust\ for\ a\ 'big'\ matrix}}
\DoxyCodeLine{00558\ \ \ \ \ OpLevel\ +=\ \mbox{\hyperlink{polym_8h_ac9308e85a1e9abba7f247485552bb3ef}{geoda\_sqr}}((\textcolor{keywordtype}{double})n1)\ +\ \mbox{\hyperlink{polym_8h_ac9308e85a1e9abba7f247485552bb3ef}{geoda\_sqr}}((\textcolor{keywordtype}{double})dim\ -\/\ n2);}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keywordflow}{if}\ (OpLevel\ <\ OpBest)\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ OpBest\ =\ OpLevel;}
\DoxyCodeLine{00561\ \ \ \ \ \ \ StartBest\ =\ n1;}
\DoxyCodeLine{00562\ \ \ \ \ \};}
\DoxyCodeLine{00563\ \ \ \};}
\DoxyCodeLine{00564\ \ \ \textcolor{keywordflow}{if}\ (StartBest\ ==\ 0)\ \{}
\DoxyCodeLine{00565\ \ \ \ \ \mbox{\hyperlink{polym_8h_a76bea34d3f14396be8f647b7667fff04}{DensePolySolving}}(mt);}
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00567\ \ \ \};}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ localLevel\ =\ order[perm[StartBest]];\ \ \textcolor{comment}{//\ the\ level\ of\ the\ belt}}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \ \ \textcolor{comment}{//\ \ \ find\ the\ new\ Pseudo\ for\ the\ 1st\ half}}
\DoxyCodeLine{00572\ \ \ n2\ =\ StartBest;}
\DoxyCodeLine{00573\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ count\ =\ 0;}
\DoxyCodeLine{00574\ \ \ \textcolor{keywordflow}{if}\ (localLevel\ ==\ 1)}
\DoxyCodeLine{00575\ \ \ \ \ count\ =\ 1;}
\DoxyCodeLine{00576\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keywordflow}{while}\ (order[perm[-\/-\/n2]]\ ==\ localLevel\ -\/\ 1)\ ++count;}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \textcolor{comment}{//\ \ find\ the\ start\ of\ the\ second\ half}}
\DoxyCodeLine{00580\ \ \ n2\ =\ StartBest;}
\DoxyCodeLine{00581\ \ \ \textcolor{keywordflow}{while}\ (order[perm[n2]]\ ==\ localLevel)\ ++n2;}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \mbox{\hyperlink{class_vector}{Vector<INDEX>}}\ InvPerm(dim);}
\DoxyCodeLine{00584\ \ \ \textcolor{keywordflow}{for}\ (n1\ =\ 0;\ n1\ <\ dim;\ ++n1)\ InvPerm[perm[n1]]\ =\ n1;}
\DoxyCodeLine{00585\ \ \ \textcolor{comment}{//\ now\ n2\ indicates\ beginning\ of\ the\ 2nd\ submatrix}}
\DoxyCodeLine{00586\ \ \ \textcolor{keywordflow}{for}\ (n1\ =\ StartBest;\ n1\ <\ n2;\ ++n1)\ \{\ \ \textcolor{comment}{//\ for\ each\ elt\ on\ the\ belt}}
\DoxyCodeLine{00587\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WPair>}}\ itr\ =\ mt[perm[n1]]();}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordtype}{bool}\ NoNbrsInSecond\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ itr;\ ++itr)}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (InvPerm[(*itr).first]\ >=\ n2)\ \{}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ NoNbrsInSecond\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{keywordflow}{if}\ (NoNbrsInSecond)\ \{\ \ \textcolor{comment}{//\ this\ elt\ on\ the\ belt\ does\ not\ have\ nbrs\ in\ the\ second\ submatrix\ -\/>}}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ move\ it\ from\ the\ belt\ to\ the\ first\ submatrix}}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_a6a4288add566c8d9c96f7cb0dc661c66}{CNT}}\ tmp\ =\ perm[StartBest];}
\DoxyCodeLine{00597\ \ \ \ \ \ \ perm[StartBest]\ =\ perm[n1];}
\DoxyCodeLine{00598\ \ \ \ \ \ \ perm[n1]\ =\ tmp;}
\DoxyCodeLine{00599\ \ \ \ \ \ \ ++StartBest;}
\DoxyCodeLine{00600\ \ \ \ \ \ \ ++count;}
\DoxyCodeLine{00601\ \ \ \ \ \};}
\DoxyCodeLine{00602\ \ \ \};}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \textcolor{keywordflow}{for}\ (n1\ =\ 0;\ n1\ <\ StartBest;\ ++n1)\ InvPerm[perm[n1]]\ =\ n1;\ \ \textcolor{comment}{//\ 1st\ half}}
\DoxyCodeLine{00605\ \ \ n2\ =\ dim\ -\/\ 1;}
\DoxyCodeLine{00606\ \ \ \textcolor{keywordflow}{for}\ (;\ order[perm[n1]]\ ==\ localLevel;\ ++n1,\ -\/-\/n2)\ \ \textcolor{comment}{//\ place\ the\ belt\ at\ the\ end}}
\DoxyCodeLine{00607\ \ \ \ \ InvPerm[perm[n1]]\ =\ n2;}
\DoxyCodeLine{00608\ \ \ n2\ =\ n1\ -\/\ StartBest;\ \ \ \ \textcolor{comment}{//\ keep\ width\ of\ the\ belt}}
\DoxyCodeLine{00609\ \ \ \textcolor{keywordflow}{for}\ (;\ n1\ <\ dim;\ ++n1)\ \ \textcolor{comment}{//\ 2nd\ half\ between\ them}}
\DoxyCodeLine{00610\ \ \ \ \ InvPerm[perm[n1]]\ =\ n1\ -\/\ n2;}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \mbox{\hyperlink{polym_8h_aeb5dc3aae4617b1ecd855c54d6d10565}{Rename}}(mt,\ InvPerm.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}());}
\DoxyCodeLine{00613\ \ \ Second\ =\ n2;}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ \ \ PseudoCount\ =\ count;}
\DoxyCodeLine{00616\ \ \ \textcolor{keywordflow}{return}\ StartBest;}
\DoxyCodeLine{00617\ \}}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \mbox{\hyperlink{polym_8h_aefa3295517e3c2de8b707231c86511b6}{SplitSparseOld}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Pseudo,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \&Level,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ \&Second)\ \{}
\DoxyCodeLine{00620\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}(),\ OldLevel;}
\DoxyCodeLine{00621\ \ \ \mbox{\hyperlink{class_vector}{Vector<INDEX>}}\ perm(dim,\ 0),\ order(dim);}
\DoxyCodeLine{00622\ \ \ \textcolor{comment}{//\ find\ pseudoperipheral}}
\DoxyCodeLine{00623\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00624\ \ \ \ \ \mbox{\hyperlink{class_vector}{Vector<INDEX>}}\ InitOrder(dim,\ dim\ +\ 1);}
\DoxyCodeLine{00625\ \ \ \ \ OldLevel\ =\ Level;}
\DoxyCodeLine{00626\ \ \ \ \ \mbox{\hyperlink{polym_8h_a622cc3d52b0eb88a1045e15a4d0ae04a}{LevelStructure}}(mt,\ Pseudo,\ Level,\ perm(),\ InitOrder.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}());}
\DoxyCodeLine{00627\ \ \ \ \ order.\mbox{\hyperlink{class_vector_a3cd35c20c654363bb9e0c3ea77f977e0}{Swap}}(InitOrder);}
\DoxyCodeLine{00628\ \ \ \}\ \textcolor{keywordflow}{while}\ (Level\ >\ OldLevel);}
\DoxyCodeLine{00629\ \ \ OldLevel\ =\ Level;}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ n1,\ n2\ =\ 1,\ StartBest\ =\ 0;}
\DoxyCodeLine{00632\ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ OpBest\ =\ dim\ *\ \mbox{\hyperlink{polym_8h_ac9308e85a1e9abba7f247485552bb3ef}{geoda\_sqr}}((\textcolor{keywordtype}{double})dim),\ OpLevel;}
\DoxyCodeLine{00633\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ lev\ =\ 1;\ lev\ <\ OldLevel\ -\/\ 1;\ ++lev)\ \{}
\DoxyCodeLine{00634\ \ \ \ \ n1\ =\ n2;}
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{keywordflow}{while}\ (order[perm[n2]]\ ==\ lev)\ ++n2;}
\DoxyCodeLine{00636\ \ \ \ \ OpLevel\ =\ (n2\ -\/\ n1)\ *\ dim;}
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordflow}{if}\ (dim\ <\ 300)\ OpLevel\ *=\ 2;}
\DoxyCodeLine{00638\ \ \ \ \ OpLevel\ +=\ \mbox{\hyperlink{polym_8h_ac9308e85a1e9abba7f247485552bb3ef}{geoda\_sqr}}((\textcolor{keywordtype}{double})n1)\ +\ \mbox{\hyperlink{polym_8h_ac9308e85a1e9abba7f247485552bb3ef}{geoda\_sqr}}((\textcolor{keywordtype}{double})dim\ -\/\ n2);}
\DoxyCodeLine{00639\ \ \ \ \ \textcolor{keywordflow}{if}\ (OpLevel\ <\ OpBest)\ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ OpBest\ =\ OpLevel;}
\DoxyCodeLine{00641\ \ \ \ \ \ \ StartBest\ =\ n1;}
\DoxyCodeLine{00642\ \ \ \ \ \};}
\DoxyCodeLine{00643\ \ \ \};}
\DoxyCodeLine{00644\ \ \ \textcolor{keywordflow}{if}\ (StartBest\ ==\ 0)\ \{}
\DoxyCodeLine{00645\ \ \ \ \ \mbox{\hyperlink{polym_8h_a76bea34d3f14396be8f647b7667fff04}{DensePolySolving}}(mt);}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00647\ \ \ \};}
\DoxyCodeLine{00648\ \ \ Level\ =\ order[perm[StartBest]];\ \ \textcolor{comment}{//\ the\ level\ of\ the\ belt}}
\DoxyCodeLine{00649\ \ \ \mbox{\hyperlink{class_vector}{Vector<INDEX>}}\ InvPerm(dim);}
\DoxyCodeLine{00650\ \ \ \textcolor{keywordflow}{for}\ (n1\ =\ 0;\ n1\ <\ StartBest;\ ++n1)\ InvPerm[perm[n1]]\ =\ n1;\ \ \textcolor{comment}{//\ 1st\ half}}
\DoxyCodeLine{00651\ \ \ n2\ =\ dim\ -\/\ 1;}
\DoxyCodeLine{00652\ \ \ \textcolor{keywordflow}{for}\ (;\ order[perm[n1]]\ ==\ Level;\ ++n1,\ -\/-\/n2)\ \ \textcolor{comment}{//\ place\ the\ belt\ at\ the\ end}}
\DoxyCodeLine{00653\ \ \ \ \ InvPerm[perm[n1]]\ =\ n2;}
\DoxyCodeLine{00654\ \ \ n2\ =\ n1\ -\/\ StartBest;\ \ \ \ \textcolor{comment}{//\ keep\ width\ of\ the\ belt}}
\DoxyCodeLine{00655\ \ \ \textcolor{keywordflow}{for}\ (;\ n1\ <\ dim;\ ++n1)\ \ \textcolor{comment}{//\ 2nd\ half\ between\ them}}
\DoxyCodeLine{00656\ \ \ \ \ InvPerm[perm[n1]]\ =\ n1\ -\/\ n2;}
\DoxyCodeLine{00657\ \ \ \mbox{\hyperlink{polym_8h_aeb5dc3aae4617b1ecd855c54d6d10565}{Rename}}(mt,\ InvPerm.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}());}
\DoxyCodeLine{00658\ \ \ Second\ =\ n2;}
\DoxyCodeLine{00659\ \ \ \textcolor{keywordflow}{return}\ StartBest;}
\DoxyCodeLine{00660\ \}}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_af1c7749bc4934f25849032d35c8beed9}{SparsePoly}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt);}
\DoxyCodeLine{00663\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a557ef056710cede1495d4c331cb31b1c}{SparseBlockPoly}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Pseudo);}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_abb49292e91ec68878ad6be06e0f73543}{SelectBlockPolyNE}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ StartBest,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ PseudoCount)\ \{}
\DoxyCodeLine{00666\ \ \ \textcolor{comment}{//***\ this\ routine\ alters\ the\ sparse\ matrix\ -\/>\ does\ not\ require\ extra\ memory}}
\DoxyCodeLine{00667\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ it(mt.\mbox{\hyperlink{class_iterator_a6e5276437e645efc8da75c4609fdff5b}{first}}(),\ StartBest);\ \ \textcolor{comment}{//\ select\ the\ submatrix\ to\ work\ with}}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ count\ =\ StartBest,\ Pseudo\ =\ 0;}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ cnt\ =\ 1;\ cnt\ <=\ PseudoCount;\ ++cnt)\ \{}
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ thisCount\ =\ mt[StartBest\ -\/\ cnt].\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keywordflow}{if}\ (thisCount\ <=\ count)\ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ count\ =\ thisCount;}
\DoxyCodeLine{00675\ \ \ \ \ \ \ Pseudo\ =\ StartBest\ -\/\ cnt;}
\DoxyCodeLine{00676\ \ \ \ \ \};}
\DoxyCodeLine{00677\ \ \ \};}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \mbox{\hyperlink{polym_8h_a557ef056710cede1495d4c331cb31b1c}{SparseBlockPoly}}(it,\ Pseudo);}
\DoxyCodeLine{00680\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00681\ \}}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00683\ \textcolor{comment}{//\ procedure\ to\ rename\ the\ references\ in\ the\ sparse\ matrix\ by\ deducting\ Deduct}}
\DoxyCodeLine{00684\ \textcolor{comment}{//\ (thus\ taking\ offset\ out\ from\ the\ submatrix)}}
\DoxyCodeLine{00685\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a96dd1cdaa9b0000c0475ad715c3148e5}{PartialRename}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ it,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Deduct)\ \{}
\DoxyCodeLine{00686\ \ \ \textcolor{keywordflow}{for}\ (;\ it;\ ++it)}
\DoxyCodeLine{00687\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{class_iterator}{Iterator<WPair>}}\ itr\ =\ (*it)();\ itr;\ ++itr)\ (*itr).first\ -\/=\ Deduct;}
\DoxyCodeLine{00688\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00689\ \}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_aefe68e52b1679297acdda70b93f684dd}{SelectPolyNE}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ StartBest,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Stop)\ \{}
\DoxyCodeLine{00692\ \ \ \textcolor{comment}{//***\ this\ routine\ works\ on\ the\ original\ sparse\ matrix}}
\DoxyCodeLine{00693\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ it(mt.\mbox{\hyperlink{class_iterator_a6e5276437e645efc8da75c4609fdff5b}{first}}()\ +\ StartBest,\ Stop\ -\/\ StartBest);}
\DoxyCodeLine{00694\ \ \ \mbox{\hyperlink{polym_8h_a96dd1cdaa9b0000c0475ad715c3148e5}{PartialRename}}(it,\ StartBest);}
\DoxyCodeLine{00695\ \ \ \mbox{\hyperlink{polym_8h_af1c7749bc4934f25849032d35c8beed9}{SparsePoly}}(it);}
\DoxyCodeLine{00696\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00697\ \}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \textcolor{comment}{/*}}
\DoxyCodeLine{00700\ \textcolor{comment}{\ \ \ \ \ \ \ \ SparseBlockPoly}}
\DoxyCodeLine{00701\ \textcolor{comment}{mt\ -\/\ sparse\ matrix\ of\ connected\ elements;}}
\DoxyCodeLine{00702\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00703\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_a557ef056710cede1495d4c331cb31b1c}{SparseBlockPoly}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Pseudo)\ \{}
\DoxyCodeLine{00704\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}();}
\DoxyCodeLine{00705\ \ \ \textcolor{keywordflow}{if}\ (dim\ <=\ \mbox{\hyperlink{polym_8h_a089c2e12eb41c55e339649240bb94c51}{SL\_SMALL\_MATRIX}})\ \{}
\DoxyCodeLine{00706\ \ \ \ \ \mbox{\hyperlink{polym_8h_a76bea34d3f14396be8f647b7667fff04}{DensePolySolving}}(mt);}
\DoxyCodeLine{00707\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00708\ \ \ \};}
\DoxyCodeLine{00709\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ StartBest,\ n2,\ PseudoCount\ =\ 0;}
\DoxyCodeLine{00710\ \ \ StartBest\ =\ \mbox{\hyperlink{polym_8h_a7a5c04884939f8a9c40e2e0cab172486}{SplitSparse}}(mt,\ Pseudo,\ n2,\ PseudoCount);}
\DoxyCodeLine{00711\ \ \ \textcolor{keywordflow}{if}\ (StartBest\ ==\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00712\ \ \ \mbox{\hyperlink{lite2_8h_ae9d1896edbd59cd55628634470738d01}{WVector}}\ *First\ =\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}}.last()\ +\ 1;\ \ \textcolor{comment}{//\ first\ poly\ introduced\ in\ this\ routine}}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00714\ \ \ \mbox{\hyperlink{class_vector}{Vector<WVector>}}\ Bordering(n2);}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ \mbox{\hyperlink{polym_8h_abf8445d3c21621b80fa766845706b935}{SparsePolyBorderingNE}}(mt,\ n2,\ Bordering);}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \mbox{\hyperlink{polym_8h_abb49292e91ec68878ad6be06e0f73543}{SelectBlockPolyNE}}(mt,\ StartBest,\ PseudoCount);}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \mbox{\hyperlink{polym_8h_aefe68e52b1679297acdda70b93f684dd}{SelectPolyNE}}(mt,\ StartBest,\ dim\ -\/\ n2);}
\DoxyCodeLine{00721\ }
\DoxyCodeLine{00722\ \ \ \mbox{\hyperlink{polym_8h_a1369c7b447e333a1a3198034b1b7b355}{PolyOrganize}}(First,\ dim\ -\/\ n2\ +\ 1,\ Bordering());}
\DoxyCodeLine{00723\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00724\ \}}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \textcolor{comment}{/*}}
\DoxyCodeLine{00727\ \textcolor{comment}{\ \ \ \ \ \ \ \ SparsePoly}}
\DoxyCodeLine{00728\ \textcolor{comment}{mt\ -\/\ sparse\ matrix;}}
\DoxyCodeLine{00729\ \textcolor{comment}{Precision\ -\/\ number\ of\ charactersitic\ coeffs\ required;}}
\DoxyCodeLine{00730\ \textcolor{comment}{Poly\ -\/\ \ container\ with\ blocks\ of\ characteristic}}
\DoxyCodeLine{00731\ \textcolor{comment}{polynomial\ (should\ be\ previously\ allocated);}}
\DoxyCodeLine{00732\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00733\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{polym_8h_af1c7749bc4934f25849032d35c8beed9}{SparsePoly}}(\mbox{\hyperlink{class_iterator}{Iterator<WMap>}}\ mt)\ \{}
\DoxyCodeLine{00734\ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ dim\ =\ mt.\mbox{\hyperlink{class_iterator_afd338869f80ec5af59561f9aeae65b21}{count}}(),\ Level,\ Blocks,\ Pseudo(0);}
\DoxyCodeLine{00735\ \ \ \mbox{\hyperlink{class_vector}{Vector<INDEX>}}\ perm(dim,\ 0),\ order(dim\ +\ 1,\ dim\ +\ 1);}
\DoxyCodeLine{00736\ \ \ Blocks\ =\ \mbox{\hyperlink{polym_8h_a622cc3d52b0eb88a1045e15a4d0ae04a}{LevelStructure}}(mt,\ Pseudo,\ Level,\ perm(),\ order.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}());}
\DoxyCodeLine{00737\ \ \ \textcolor{keywordflow}{if}\ (Blocks\ >\ 1)\ \{}
\DoxyCodeLine{00738\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<INDEX>}}\ iperm\ =\ perm();}
\DoxyCodeLine{00739\ \ \ \ \ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Block\ =\ 0;}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ iperm;\ ++iperm)\ \{}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (order[*iperm]\ ==\ 0)\ ++Block;}
\DoxyCodeLine{00742\ \ \ \ \ \ \ order[*iperm]\ =\ Block;}
\DoxyCodeLine{00743\ \ \ \ \ \}\ \ \textcolor{comment}{//\ order[x]\ shows\ to\ which\ block\ x\ belongs\ to}}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{keywordflow}{for}\ (Block\ =\ 0,\ iperm\ =\ perm();\ Block\ <\ Blocks;\ ++Block)\ \{}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (order[*iperm]\ <=\ Block)\ ++iperm;}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \mbox{\hyperlink{lite2_8h_a4c7688b643a08fd9b048deecbb9376b5}{GWT}}\ SubMatrix;}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_a32c764c7c1a9272f0bdbc0a730225ba2}{SparseSubMatrix}}(mt,\ iperm,\ order.\mbox{\hyperlink{class_vector_a53aad8ce8c9b993a8d4db1734a8f7cee}{first}}(),\ SubMatrix);}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \mbox{\hyperlink{polym_8h_a557ef056710cede1495d4c331cb31b1c}{SparseBlockPoly}}(SubMatrix(),\ 0);}
\DoxyCodeLine{00749\ \ \ \ \ \}}
\DoxyCodeLine{00750\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00751\ \ \ \ \ perm.destroy();}
\DoxyCodeLine{00752\ \ \ \ \ order.\mbox{\hyperlink{class_vector_a557dae0338b7c4f08a58cae39a7df869}{destroy}}();}
\DoxyCodeLine{00753\ \ \ \ \ \mbox{\hyperlink{polym_8h_a557ef056710cede1495d4c331cb31b1c}{SparseBlockPoly}}(mt,\ Pseudo);}
\DoxyCodeLine{00754\ \ \ \}}
\DoxyCodeLine{00755\ \}}
\DoxyCodeLine{00756\ }
\DoxyCodeLine{00757\ \textcolor{comment}{//\ computes\ log\ of\ the\ polynomial\ stored\ in\ Poly:}}
\DoxyCodeLine{00758\ \textcolor{comment}{//\ as\ a\ sum\ of\ logs\ of\ each\ polynomial}}
\DoxyCodeLine{00759\ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ \mbox{\hyperlink{polym_8h_a50bd3effbed49185c43d5d1f6e5fd810}{OnePoly}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ Val,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Prec,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Pr)\ \{}
\DoxyCodeLine{00760\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ it;}
\DoxyCodeLine{00761\ \ \ \mbox{\hyperlink{class_vector}{Vector<VALUE>}}\ Power(Prec);}
\DoxyCodeLine{00762\ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ S\ =\ 1,\ LogJ\ =\ 0;}
\DoxyCodeLine{00763\ \ \ \textcolor{keywordtype}{bool}\ first\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00764\ \ \ \textcolor{keywordflow}{while}\ (Power)\ \{}
\DoxyCodeLine{00765\ \ \ \ \ Power\ <<\ S;}
\DoxyCodeLine{00766\ \ \ \ \ S\ *=\ Val;}
\DoxyCodeLine{00767\ \ \ \};}
\DoxyCodeLine{00768\ \ \ \textcolor{keywordflow}{for}\ (;\ Pr\ <\ Prec;\ ++Pr)\ Power[Pr]\ =\ 0;}
\DoxyCodeLine{00769\ \ \ \textcolor{keywordflow}{for}\ (it\ =\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};\ it;\ ++it)\ \{}
\DoxyCodeLine{00770\ \ \ \ \ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ itr\ =\ (*it)();}
\DoxyCodeLine{00771\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<VALUE>}}\ Po\ =\ Power();}
\DoxyCodeLine{00772\ \ \ \ \ S\ =\ 0;}
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ itr;\ ++itr,\ ++Po)\ S\ +=\ *itr\ *\ *Po;}
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{keywordflow}{if}\ (S\ <\ 1.0e-\/16)\ \{}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (first)\ \{}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ "{}\ S\ is\ small=\ "{}\ <<\ S\ <<\ "{}\ \ val:\ "{}\ <<\ Val\ <<\ std::endl;}}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ first\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00779\ \ \ \ \ \ \ S\ =\ 1.0e-\/16;}
\DoxyCodeLine{00780\ \ \ \ \ \};}
\DoxyCodeLine{00781\ \ \ \ \ LogJ\ +=\ log(S);}
\DoxyCodeLine{00782\ \ \ \};}
\DoxyCodeLine{00783\ \ \ \textcolor{keywordflow}{return}\ LogJ;}
\DoxyCodeLine{00784\ \}}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ \mbox{\hyperlink{polym_8h_a303bc3e7da1c5ac7b10ff52915ba50b3}{OnePrime}}(\mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ Val,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Prec,\ \mbox{\hyperlink{lite2_8h_ac6885dbfb371c33e523c7fb046118b36}{INDEX}}\ Pr)\ \{}
\DoxyCodeLine{00787\ \ \ \mbox{\hyperlink{class_iterator}{Iterator<WVector>}}\ it;}
\DoxyCodeLine{00788\ \ \ \mbox{\hyperlink{class_vector}{Vector<VALUE>}}\ Power(Prec);}
\DoxyCodeLine{00789\ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ S\ =\ 1,\ \mbox{\hyperlink{lite2_8h_aa1370876f2c781f443356f2a7b4d4b9c}{Sum}}\ =\ 0;}
\DoxyCodeLine{00790\ \ \ \textcolor{keywordtype}{long}\ cnt;}
\DoxyCodeLine{00791\ \ \ \textcolor{keywordflow}{while}\ (Power)\ \{}
\DoxyCodeLine{00792\ \ \ \ \ Power\ <<\ S;}
\DoxyCodeLine{00793\ \ \ \ \ S\ *=\ Val;}
\DoxyCodeLine{00794\ \ \ \};}
\DoxyCodeLine{00795\ \ \ \textcolor{keywordflow}{for}\ (;\ Pr\ <\ Prec;\ ++Pr)\ Power[Pr]\ =\ 0;}
\DoxyCodeLine{00796\ \ \ \textcolor{keywordflow}{for}\ (it\ =\ \mbox{\hyperlink{polym_8h_af612757c1d1352066bd1b8773453e5d2}{Poly}};\ it;\ ++it)\ \{}
\DoxyCodeLine{00797\ \ \ \ \ \mbox{\hyperlink{lite2_8h_a3a00b1c836acf59360ffc84741af61c6}{WIterator}}\ itr\ =\ (*it)();}
\DoxyCodeLine{00798\ \ \ \ \ \mbox{\hyperlink{class_iterator}{Iterator<VALUE>}}\ Po\ =\ Power();}
\DoxyCodeLine{00799\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa0b03826c8f7cc324ac2db0ada2dce0a}{VALUE}}\ S1\ =\ 0;}
\DoxyCodeLine{00800\ \ \ \ \ S\ =\ 1;}
\DoxyCodeLine{00801\ \ \ \ \ cnt\ =\ 1;}
\DoxyCodeLine{00802\ \ \ \ \ ++itr;}
\DoxyCodeLine{00803\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ itr;\ ++itr,\ ++cnt)\ \{}
\DoxyCodeLine{00804\ \ \ \ \ \ \ S1\ +=\ *itr\ *\ cnt\ *\ *Po;}
\DoxyCodeLine{00805\ \ \ \ \ \ \ ++Po;}
\DoxyCodeLine{00806\ \ \ \ \ \ \ S\ +=\ *itr\ *\ *Po;}
\DoxyCodeLine{00807\ \ \ \ \ \};}
\DoxyCodeLine{00808\ \ \ \ \ \mbox{\hyperlink{lite2_8h_aa1370876f2c781f443356f2a7b4d4b9c}{Sum}}\ +=\ S1\ /\ S;}
\DoxyCodeLine{00809\ \ \ \};}
\DoxyCodeLine{00810\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{lite2_8h_aa1370876f2c781f443356f2a7b4d4b9c}{Sum}};}
\DoxyCodeLine{00811\ \}}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
