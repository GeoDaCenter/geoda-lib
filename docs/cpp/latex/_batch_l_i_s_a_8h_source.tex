\doxysection{Batch\+LISA.\+h}
\hypertarget{_batch_l_i_s_a_8h_source}{}\label{_batch_l_i_s_a_8h_source}\index{/Users/xun/github/geoda-\/lib/src/cpp/lisa/BatchLISA.h@{/Users/xun/github/geoda-\/lib/src/cpp/lisa/BatchLISA.h}}
\mbox{\hyperlink{_batch_l_i_s_a_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Created\ by\ Xun\ Li\ on\ 2019-\/06-\/05.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ GEODA\_BATCHLISA\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ GEODA\_BATCHLISA\_H}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ for\ uint64\_t\ typedef}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../pg/geoms.h"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <list>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_geo_da_weight}{GeoDaWeight}};}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_batch_l_i_s_a_a63f499cde5d347aa148e7ff02a5b3379}{BatchLISA}}\ \{}
\DoxyCodeLine{00021\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00022\ \ \ \mbox{\hyperlink{class_batch_l_i_s_a_a63f499cde5d347aa148e7ff02a5b3379}{BatchLISA}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_acfa114b6646825683aa75107e95d3e77}{num\_obs}},\ \mbox{\hyperlink{class_geo_da_weight}{GeoDaWeight}}*\ w,\ \textcolor{keyword}{const}\ std::vector<std::vector<bool>\ >\&\ \mbox{\hyperlink{class_batch_l_i_s_a_abd135602bbc27fbeaf18f4284c185995}{undefs}},\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_batch_l_i_s_a_aae887eeb8b3fd9a42ef60c399de53bc7}{significance\_cutoff}},}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_a772e893eb6919dbb8a904d2b9cc293cb}{nCPUs}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_aa68604b747006dc0da9dd22a4276ec2e}{permutations}},\ uint64\_t\ \mbox{\hyperlink{class_batch_l_i_s_a_a58da92a3ad297dd294b8631395d3e2e6}{last\_seed\_used}});}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{class_batch_l_i_s_a_aa4239554d60029952c2b095db1ab50fa}{\string~BatchLISA}}();}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_a912364a71106968ed77f4f4b17122f81}{ComputeLoalSA}}()\ =\ 0;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_af4ba7dffdb88a6edb74cfb17103bf4cd}{CalcPseudoP}}();}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_a206db1935f2bcfe824a0a213839c0510}{CalcPseudoP\_threaded}}();}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_a01346ac98a9204ed99d2a0d9dc2a0595}{CalcPseudoP\_range}}(\textcolor{keywordtype}{int}\ obs\_start,\ \textcolor{keywordtype}{int}\ obs\_end,\ uint64\_t\ seed\_start);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ compare\ local\ SA\ value\ of\ current\ obs\ to\ local\ SA\ values\ of\ random\ picked\ nbrs}}
\DoxyCodeLine{00036\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_a7ed3bc7770e54c05637c1ab43fd86690}{PermLocalSA}}(\textcolor{keywordtype}{int}\ cnt,\ \textcolor{keywordtype}{int}\ perm,\ \textcolor{keyword}{const}\ std::vector<int>\&\ permNeighbors,}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<std::vector<double>\ >\&\ permutedSA)\ =\ 0;}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{virtual}\ std::vector<uint64\_t>\ \mbox{\hyperlink{class_batch_l_i_s_a_a936e4be0882cd88adf07c6053ef2d6f4}{CountLargerSA}}(\textcolor{keywordtype}{int}\ cnt,\ \textcolor{keyword}{const}\ std::vector<std::vector<double>\ >\&\ permutedSA)\ =\ 0;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_afc0199862116962406688e23d9cb8eec}{Run}}();}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_ab0ca50fa4fd73926f8e99144cc609536}{SetSignificanceFilter}}(\textcolor{keywordtype}{int}\ filter\_id);}
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_a7e6aac14436d0ebaa717e596b6db909a}{GetSignificanceFilter}}();}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_batch_l_i_s_a_ad0e884d33d8a01b6606f83fc9fb94169}{GetSignificanceCutoff}}();}
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_a6a7b354a62bf1812e6d633481299f854}{SetSignificanceCutoff}}(\textcolor{keywordtype}{double}\ val);}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_batch_l_i_s_a_a261bbb74d46f4fd628506d51e99d4d74}{GetUserCutoff}}();}
\DoxyCodeLine{00050\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_aa273824fa66082932a8988e8a8b2102d}{SetUserCutoff}}(\textcolor{keywordtype}{double}\ val);}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_batch_l_i_s_a_a6a212260baeee4c914bb9752627508ef}{GetBO}}(\textcolor{keywordtype}{double}\ current\_p);}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_batch_l_i_s_a_a6684f63321d322bf1cc3d8107049b976}{GetFDR}}(\textcolor{keywordtype}{double}\ current\_p,\ \textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_aa54c7033fee3b3477f5ab7f3d4203433}{GetNumPermutations}}();}
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_ac62c00856e07ed02a886ca146809b5fd}{SetNumPermutations}}(\textcolor{keywordtype}{int}\ val);}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{keyword}{virtual}\ uint64\_t\ \mbox{\hyperlink{class_batch_l_i_s_a_a48922390f1e7f318efd693c3ccd4b463}{GetLastUsedSeed}}();}
\DoxyCodeLine{00060\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_a6b0349e58232f861fb9f22438ebc669b}{SetLastUsedSeed}}(uint64\_t\ seed);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_a0234412dac2672683fb26900285c62ea}{IsReuseLastSeed}}();}
\DoxyCodeLine{00063\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_afd8ed58b76ae0679e574abc28ef49b26}{SetReuseLastSeed}}(\textcolor{keywordtype}{bool}\ reuse);}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_acb8fafedd7b86af1be217ffb2d25305d}{GetHasIsolates}}();}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_a3f77fd90f006297c210a034c43c88e92}{GetHasUndefined}}();}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{virtual}\ std::vector<std::string>\ \mbox{\hyperlink{class_batch_l_i_s_a_af21c99ed8a15fc79fae2debe76da6dd4}{GetDefaultCategories}}();}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \textcolor{keyword}{virtual}\ std::vector<double>\ \mbox{\hyperlink{class_batch_l_i_s_a_a963b68a3a3772360cd04539fc17f29a8}{GetDefaultCutoffs}}();}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{keyword}{virtual}\ std::vector<double>\ \mbox{\hyperlink{class_batch_l_i_s_a_ab1d543fade2290fff4f48b4be2171e1f}{GetLocalSignificanceValues}}(\textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \textcolor{keyword}{virtual}\ std::vector<int>\ \mbox{\hyperlink{class_batch_l_i_s_a_a64668148f4f1ed44c3ee726de14cfbd0}{GetClusterIndicators}}(\textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{keyword}{virtual}\ std::vector<int>\ \mbox{\hyperlink{class_batch_l_i_s_a_a258ee2b3d9694d11718c0c1fde55d497}{GetSigCatIndicators}}(\textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \textcolor{keyword}{virtual}\ std::vector<int>\ \mbox{\hyperlink{class_batch_l_i_s_a_a5c150d16af001c658004c762c54a30ae}{GetNumNeighbors}}();}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{virtual}\ std::vector<double>\ \mbox{\hyperlink{class_batch_l_i_s_a_a651ee834f2d0efc183f72361a478808c}{GetSpatialLagValues}}(\textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \textcolor{keyword}{virtual}\ std::vector<double>\ \mbox{\hyperlink{class_batch_l_i_s_a_ac56c5feca4a69226e04ece590847d2ff}{GetLISAValues}}(\textcolor{keywordtype}{int}\ idx);}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_ae13f7fd84d0a792c18125e5e3cc4efcc}{IsRowStandardize}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_ae78b2179938f8e1ed1223456da74c160}{SetRowStandardize}}(\textcolor{keywordtype}{bool}\ rowStandardize);}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_a2179250821133e59d7d68acec85c2f4c}{GetNumThreads}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_batch_l_i_s_a_a9718111864edefff4faba880bef21704}{SetNumThreads}}(\textcolor{keywordtype}{int}\ n\_threads);}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keyword}{virtual}\ std::vector<std::string>\ \mbox{\hyperlink{class_batch_l_i_s_a_a1ffb1f2bc4c7ac2aa1e58135aa9e1209}{GetLabels}}();}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \textcolor{keyword}{virtual}\ std::vector<std::string>\ \mbox{\hyperlink{class_batch_l_i_s_a_afc2fbced26a6154cabdd82ce68fe21e0}{GetColors}}();}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_a772e893eb6919dbb8a904d2b9cc293cb}{nCPUs}};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_acfa114b6646825683aa75107e95d3e77}{num\_obs}};\ \ \textcolor{comment}{//\ total\ \#\ obs\ including\ neighborless\ obs}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_a049f7565501a8242b3d5efa97932557a}{row\_standardize}};}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_a039f5ad06b7098574cae5e133449dee2}{significance\_filter}};\ \ \textcolor{comment}{//\ 0:\ >0.05\ 1:\ 0.05,\ 2:\ 0.01,\ 3:\ 0.001,\ 4:\ 0.0001}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_aa68604b747006dc0da9dd22a4276ec2e}{permutations}};\ \ \textcolor{comment}{//\ any\ number\ from\ 9\ to\ 99999,\ 99\ will\ be\ default}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_batch_l_i_s_a_aae887eeb8b3fd9a42ef60c399de53bc7}{significance\_cutoff}};\ \ \textcolor{comment}{//\ either\ 0.05,\ 0.01,\ 0.001\ or\ 0.0001}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_batch_l_i_s_a_a73066ebb119363b95cea0fcfb246e5ad}{user\_sig\_cutoff}};\ \ \textcolor{comment}{//\ user\ defined\ cutoff}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_a135f1b1f9e6ec0f81f579b2685ee007f}{has\_undefined}};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_a7903dcf217bf1b854772b5b0bfaafb64}{has\_isolates}};}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_a161b0aa92fd69f547d225283039174f5}{calc\_significances}};\ \ \textcolor{comment}{//\ if\ false,\ then\ p-\/vals\ will\ never\ be\ needed}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ uint64\_t\ \mbox{\hyperlink{class_batch_l_i_s_a_a58da92a3ad297dd294b8631395d3e2e6}{last\_seed\_used}};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_batch_l_i_s_a_a8306280cca5606aa7b2365bef3db69e5}{reuse\_last\_seed}};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \mbox{\hyperlink{class_geo_da_weight}{GeoDaWeight}}*\ \mbox{\hyperlink{class_batch_l_i_s_a_aa652dafdede6fe0792d434db2f1d0010}{weights}};}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_batch_l_i_s_a_addfa51ca3a3e1869edcd2342c5bf50f0}{num\_batch}};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \textcolor{comment}{//\ return\ values\ for\ all\ input\ variables}}
\DoxyCodeLine{00127\ \ \ std::vector<std::vector<bool>\ >\ \mbox{\hyperlink{class_batch_l_i_s_a_abd135602bbc27fbeaf18f4284c185995}{undefs}};}
\DoxyCodeLine{00128\ \ \ std::vector<std::vector<double>\ >\ \mbox{\hyperlink{class_batch_l_i_s_a_a35a6414f3ed4f44e5828e68bcc0f9160}{sig\_local\_vec}};}
\DoxyCodeLine{00129\ \ \ std::vector<std::vector<int>\ >\ \mbox{\hyperlink{class_batch_l_i_s_a_ac7d1f7d2ef8d4e236c7c3df80773df5f}{sig\_cat\_vec}};}
\DoxyCodeLine{00130\ \ \ std::vector<std::vector<int>\ >\ \mbox{\hyperlink{class_batch_l_i_s_a_a48ff3a6e4742c47a97699d555ed44155}{cluster\_vec}};}
\DoxyCodeLine{00131\ \ \ std::vector<std::vector<double>\ >\ \mbox{\hyperlink{class_batch_l_i_s_a_aa25fa791b1d3cfb2c9dd1d3f3b8a3bf1}{lag\_vec}};}
\DoxyCodeLine{00132\ \ \ std::vector<std::vector<double>\ >\ \mbox{\hyperlink{class_batch_l_i_s_a_ae1592bab99cab0a3cb937fb0edccf184}{lisa\_vec}};}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ std::vector<int>\ \mbox{\hyperlink{class_batch_l_i_s_a_a8eee5f68e8274762ff9aa69ab4902d0f}{nn\_vec}};}
\DoxyCodeLine{00135\ \ \ std::vector<std::string>\ \mbox{\hyperlink{class_batch_l_i_s_a_a25b06a3d5d9d1ef551607671d10a352f}{labels}};}
\DoxyCodeLine{00136\ \ \ std::vector<std::string>\ \mbox{\hyperlink{class_batch_l_i_s_a_a7b23e882e584108cd4748fee1f034d42}{colors}};}
\DoxyCodeLine{00137\ \};}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GEODA\_BATCHLISA\_H}}

\end{DoxyCode}
